### Документация для API интернет-магазина ювелирных изделий

#### Стек технологий:
- **Backend**: Node.js, Express
- **База данных**: AWS MySQL
- **Хранилище файлов**: AWS S3 Bucket
- **Модули и библиотеки**:
  - `@aws-sdk/client-s3` (работа с S3)
  - `uuidv4` (генерация уникальных идентификаторов)
  - `multer` (загрузка файлов)
  - `sharp` (обработка изображений)
  - `dotenv` (управление переменными окружения)

#### Функционал:
1. Управление продуктами:
   - Добавление новых товаров.
   - Получение данных о товарах.
   - Редактирование товаров.
   - Удаление товаров.
2. Загрузка и хранение изображений:
   - Поддержка загрузки до 4 изображений на товар.
   - Обработка изображений (изменение размера, вращение).
   - Хранение изображений в AWS S3.
3. Управление блогом:
   - Добавление новых статей блога.
   - Получение данных о статьях блога.
   - Редактирование статей блога.
   - Удаление статей блога.
4. Генерация подписанных URL-адресов для изображений.
5. Аутентификация для изменения данных с использованием middleware `authcheck`.

---

### Описание API

#### 1. **Получение информации о товаре по ID**
- **Метод**: `GET`
- **Эндпоинт**: `/get/:id`
- **Описание**: Возвращает данные о товаре по его идентификатору.
- **Параметры**:
  - `id`: Уникальный идентификатор товара.
- **Пример ответа**:
```json
{
  "uid": "123e4567-e89b-12d3-a456-426614174000",
  "name": "Золотое кольцо",
  "price": 1500,
  "images": ["https://s3.amazonaws.com/..."]
}
```

---

#### 2. **Получение списка всех товаров**
- **Метод**: `GET`
- **Эндпоинт**: `/`
- **Описание**: Возвращает список всех товаров.
- **Пример ответа**:
```json
[
  {
    "uid": "123e4567-e89b-12d3-a456-426614174000",
    "name": "Золотое кольцо",
    "price": 1500,
    "images": ["https://s3.amazonaws.com/..."]
  },
  {
    "uid": "456e4567-e89b-12d3-a456-426614174000",
    "name": "Серебряная цепочка",
    "price": 500,
    "images": ["https://s3.amazonaws.com/..."]
  }
]
```

---

#### 3. **Добавление нового товара**
- **Метод**: `POST`
- **Эндпоинт**: `/post`
- **Описание**: Добавляет новый товар.
- **Требуется аутентификация**: Да
- **Тело запроса**:
  - **Файлы**: до 4 изображений (поле `images`).
  - **JSON** (передается в поле `body`):
    ```json
    {
      "name": "Золотое кольцо",
      "price": 1500,
      "description": "Описание товара",
      "count": 10,
      "sizes": "S, M, L",
      "colours": "Золото, Серебро",
      "weight": "10g",
      "material": "Золото",
      "categoryname": "Кольца",
      "forSlide": "false"
    }
    ```
- **Пример ответа**:
```plaintext
Продукт добавлен с ID: 1
```

---

#### 4. **Обновление товара**
- **Метод**: `PUT`
- **Эндпоинт**: `/put/:id`
- **Описание**: Обновляет данные товара и его изображения.
- **Требуется аутентификация**: Да
- **Параметры**:
  - `id`: Уникальный идентификатор товара.
- **Тело запроса**:
  - **Файлы**: до 4 изображений (поле `images`).
  - **JSON** (передается в поле `body`):
    ```json
    {
      "name": "Золотое кольцо",
      "price": 1600,
      "description": "Обновленное описание",
      "count": 8,
      "sizes": "S, M",
      "colours": "Золото",
      "weight": "11g",
      "material": "Золото",
      "categoryname": "Кольца"
    }
    ```
- **Пример ответа**:
```plaintext
Продукт успешно обновлен
```

---

#### 5. **Удаление товара**
- **Метод**: `DELETE`
- **Эндпоинт**: `/:id`
- **Описание**: Удаляет товар и связанные с ним изображения.
- **Требуется аутентификация**: Да
- **Параметры**:
  - `id`: Уникальный идентификатор товара.
- **Пример ответа**:
```json
{
  "message": "Продукт успешно удален"
}
```

---

### Управление блогом

#### 1. **Получение информации о статье блога по ID**
- **Метод**: `GET`
- **Эндпоинт**: `/blog/get/:id`
- **Описание**: Возвращает данные о статье блога по ее идентификатору.
- **Параметры**:
  - `id`: Уникальный идентификатор статьи.
- **Пример ответа**:
```json
{
  "uid": "789e4567-e89b-12d3-a456-426614174000",
  "title": "Ювелирные изделия: история и стиль",
  "content": "История ювелирного искусства начинается с...",
  "images": ["https://s3.amazonaws.com/..."]
}
```

---

#### 2. **Получение списка всех статей блога**
- **Метод**: `GET`
- **Эндпоинт**: `/blog`
- **Описание**: Возвращает список всех статей блога.
- **Пример ответа**:
```json
[
  {
    "uid": "789e4567-e89b-12d3-a456-426614174000",
    "title": "Ювелирные изделия: история и стиль",
    "content": "История ювелирного искусства начинается с...",
    "images": ["https://s3.amazonaws.com/..."]
  },
  {
    "uid": "890e4567-e89b-12d3-a456-426614174000",
    "title": "Как выбрать кольцо",
    "content": "Выбор кольца зависит от...",
    "images": ["https://s3.amazonaws.com/..."]
  }
]
```

---

#### 3. **Добавление новой статьи блога**
- **Метод**: `POST`
- **Эндпоинт**: `/blog/post`
- **Описание**: Добавляет новую статью блога.
- **Требуется аутентификация**: Да
- **Тело запроса**:
  - **Файлы**: до 4 изображений (поле `images`).
  - **JSON** (передается в поле `body`):
    ```json
    {
      "title": "Ювелирные изделия: история и стиль",
      "content": "История ювелирного искусства начинается с..."
    }
    ```
- **Пример ответа**:
```plaintext
Статья блога добавлена с ID: 1
```

---

#### 4. **Обновление статьи блога**
- **Метод**: `PUT`
- **Эндпоинт**: `/blog/put/:id`
- **Описание**: Обновляет данные статьи блога и ее изображения.
- **Требуется аутентификация**: Да
- **Параметры**:
  - `id`: Уникальный идентификатор статьи.
- **Тело запроса**:
  - **Файлы**: до 4 изображений (поле `images`).
  - **JSON** (передается в поле `body`):
    ```json
    {
      "title": "Ювелирные изделия: обновленная статья",
      "content": "Обновленное содержание статьи..."
    }
    ```
- **Пример ответа**:
```plaintext
Статья блога успешно обновлена
```

---

#### 5. **Удаление статьи блога**
- **Метод**: `DELETE`
- **Эндпоинт**: `/blog/:id`
- **Описание**: Удаляет статью блога и связанные с ней изображения.
- **Требуется аутентификация**: Да
- **Параметры**:
  - `id`: Уникальный идентификатор статьи.
- **Пример ответа**:
```json
{
  "message": "Статья блога успешно удалена"
}
```

---

### Особенности:
1. **Обработка изображений**:
   - Используется `sharp` для изменения размера и оптимизации изображений перед загрузкой в S3.
   - Максимальный размер: 5000x3338 пикселей.
2. **Управление файлами в S3**:
   - `PutObjectCommand`: Загрузка изображений.
   - `GetObjectCommand`: Получение URL.
   - `DeleteObjectCommand`: Удаление изображений.
3. **Middleware**:
   - `authcheck`: Проверяет, авторизован ли пользователь перед выполнением операций с изменением данных.
4. **Безопасность**:
   - Доступ к AWS осуществляется через переменные окружения.

---

Если необходимо добавить дополнительные разделы или уточнения, дайте знать!

